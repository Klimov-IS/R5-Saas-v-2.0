# EPIC-013: ะะฝะฐะปะธัะธัะตัะบะธะต ะดะฐัะฑะพัะดั ะดะปั ะผะฐะณะฐะทะธะฝะพะฒ

**ะกัะฐััั:** ๐ Backlog
**ะัะธะพัะธัะตั:** P1 (ะััะพะบะธะน)
**RICE Score:** 100
**ะะฒะฐััะฐะป:** Q2 2025 (ะะฟัะตะปั - ะัะฝั)
**ะัะตะฝะบะฐ:** 2 ะฝะตะดะตะปะธ (10 SP)
**ะะปะฐะดะตะปะตั:** Product Manager

---

## ะัะพะฑะปะตะผะฐ

ะกะตะนัะฐั ะฒะปะฐะดะตะปััั ะผะฐะณะฐะทะธะฝะพะฒ ะฒะธะดัั ัะพะปัะบะพ ััััะต ะดะฐะฝะฝัะต (ัะฐะฑะปะธัั ะพัะทัะฒะพะฒ, ัะฐัะพะฒ), ะฝะพ ะฝะตั **ะฐะฝะฐะปะธัะธัะตัะบะธั ะธะฝัะฐะนัะพะฒ**:
- ะะฐะบะพะน ััะตะดะฝะธะน ัะตะนัะธะฝะณ ะฟะพ ะผะฐะณะฐะทะธะฝั ะทะฐ ะฟะตัะธะพะด?
- ะกะบะพะปัะบะพ ะพัะทัะฒะพะฒ ะฟะพะปััะตะฝะพ ะทะฐ ะฟะพัะปะตะดะฝะธะน ะผะตััั?
- ะะฐะบะพะน ะฟัะพัะตะฝั ัะฐัะพะฒ ััะฟะตัะฝะพ ะทะฐะบััั?
- ะะธะฝะฐะผะธะบะฐ ะฝะตะณะฐัะธะฒะฝัั ะพัะทัะฒะพะฒ ะฟะพ ะฒัะตะผะตะฝะธ

**ะะพะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน:**
- ะัะธัะพะดะธััั ะฒัััะฝัั ััะธัะฐัั ััะฐัะธััะธะบั ะฒ Excel
- ะะตะฒะพะทะผะพะถะฝะพ ะฑััััะพ ะพัะตะฝะธัั ััะตะฝะดั (ัะปัััะฐะตััั/ัััะดัะฐะตััั ัะตะฟััะฐัะธั)
- ะะตั ะดะฐะฝะฝัั ะดะปั ะฟัะธะฝััะธั ัะตัะตะฝะธะน

**ะะพะฝะบััะตะฝัั:**
- ะฃ ะบะพะฝะบััะตะฝัะพะฒ ะตััั ะฑะฐะทะพะฒัะต ะดะฐัะฑะพัะดั, ะฝะพ ะฑะตะท AI-ะธะฝัะฐะนัะพะฒ
- ะะพะทะผะพะถะฝะพััั ะดะพะฑะฐะฒะธัั ัะฝะธะบะฐะปัะฝัั ัะตะฝะฝะพััั ัะตัะตะท AI-ะฐะฝะฐะปะธะท

---

## ะะตัะตะฝะธะต

ะกะพะทะดะฐัั ะบะพะผะฟะปะตะบัะฝัะน ะฐะฝะฐะปะธัะธัะตัะบะธะน ะดะฐัะฑะพัะด ะดะปั ะบะฐะถะดะพะณะพ ะผะฐะณะฐะทะธะฝะฐ ั:
1. **ะะฑะทะพัะฝัะต ะผะตััะธะบะธ** (KPI cards): ััะตะดะฝะธะน ัะตะนัะธะฝะณ, ะบะพะป-ะฒะพ ะพัะทัะฒะพะฒ, ะฒัะตะผั ะพัะฒะตัะฐ
2. **ะัะฐัะธะบะธ ะดะธะฝะฐะผะธะบะธ**: ะพัะทัะฒั ะฟะพ ะฒัะตะผะตะฝะธ, ัะฐัะฟัะตะดะตะปะตะฝะธะต ัะตะนัะธะฝะณะพะฒ
3. **Sentiment Analysis**: ะดะพะปั ะฟะพะทะธัะธะฒะฝัั/ะฝะตะณะฐัะธะฒะฝัั/ะฝะตะนััะฐะปัะฝัั ะพัะทัะฒะพะฒ
4. **Chat Analytics**: ััะฟะตัะฝะพััั ะดะธะฐะปะพะณะพะฒ, ััะตะดะฝะตะต ะฒัะตะผั ะพัะฒะตัะฐ
5. **ะกัะฐะฒะฝะตะฝะธะต ะฟะตัะธะพะดะพะฒ**: "ะะฐ 15% ะฑะพะปััะต ะพัะทัะฒะพะฒ, ัะตะผ ะฒ ะฟัะพัะปะพะผ ะผะตัััะต"
6. **AI Insights**: ะฐะฒัะพะผะฐัะธัะตัะบะธะต ัะตะบะพะผะตะฝะดะฐัะธะธ ("ะฃะฒะตะปะธัะธะปะพัั ะบะพะป-ะฒะพ ะถะฐะปะพะฑ ะฝะฐ ะดะพััะฐะฒะบั")

---

## User Stories

### US-028: ะะฑะทะพัะฝัะน ะดะฐัะฑะพัะด ะผะฐะณะฐะทะธะฝะฐ
**ะะฐะบ:** ะฒะปะฐะดะตะปะตั ะผะฐะณะฐะทะธะฝะฐ
**ะฏ ัะพัั:** ะฒะธะดะตัั ะบะปััะตะฒัะต ะผะตััะธะบะธ ะผะฐะณะฐะทะธะฝะฐ ะฝะฐ ะพะดะฝะพะน ัััะฐะฝะธัะต
**ะงัะพะฑั:** ะฑััััะพ ะพัะตะฝะธะฒะฐัั ัะพััะพัะฝะธะต ัะตะฟััะฐัะธะธ

**Acceptance Criteria:**
- โ ะะธะถั 6 KPI cards: ััะตะดะฝะธะน ัะตะนัะธะฝะณ, ะบะพะป-ะฒะพ ะพัะทัะฒะพะฒ (ะผะตััั), ะบะพะป-ะฒะพ ัะฐัะพะฒ, % ะทะฐะบััััั ัะฐัะพะฒ, ััะตะดะฝะตะต ะฒัะตะผั ะพัะฒะตัะฐ, ะบะพะป-ะฒะพ ะถะฐะปะพะฑ
- โ ะะฐะถะดะฐั ะผะตััะธะบะฐ ะฟะพะบะฐะทัะฒะฐะตั ะธะทะผะตะฝะตะฝะธะต vs ะฟัะพัะปัะน ะฟะตัะธะพะด (+15% โ)
- โ ะัะฐัะธะบ ะดะธะฝะฐะผะธะบะธ ะพัะทัะฒะพะฒ ะทะฐ ะฟะพัะปะตะดะฝะธะต 30 ะดะฝะตะน
- โ ะััะณะพะฒะฐั ะดะธะฐะณัะฐะผะผะฐ ัะฐัะฟัะตะดะตะปะตะฝะธั ัะตะนัะธะฝะณะพะฒ (5โ: 60%, 4โ: 20%, ...)
- โ ะะพะณั ะฒัะฑัะฐัั ะฟะตัะธะพะด: 7 ะดะฝะตะน, 30 ะดะฝะตะน, 90 ะดะฝะตะน, ะณะพะด

**Story Points:** 5 SP (3-5 ะดะฝะตะน)

---

### US-029: Sentiment Analysis ะพัะทัะฒะพะฒ
**ะะฐะบ:** ะฒะปะฐะดะตะปะตั ะผะฐะณะฐะทะธะฝะฐ
**ะฏ ัะพัั:** ะฒะธะดะตัั ะดะพะปั ะฟะพะทะธัะธะฒะฝัั/ะฝะตะณะฐัะธะฒะฝัั ะพัะทัะฒะพะฒ
**ะงัะพะฑั:** ะฟะพะฝะธะผะฐัั ะพะฑัะตะต ะฝะฐัััะพะตะฝะธะต ะฟะพะบัะฟะฐัะตะปะตะน

**Acceptance Criteria:**
- โ ะะธะถั ะณัะฐัะธะบ: ะฟะพะทะธัะธะฒะฝัะต (green), ะฝะตะนััะฐะปัะฝัะต (yellow), ะฝะตะณะฐัะธะฒะฝัะต (red)
- โ ะะธะฝะฐะผะธะบะฐ sentiment ะฟะพ ะฒัะตะผะตะฝะธ (ััะตะฝะด)
- โ ะะพะณั ะบะปะธะบะฝััั ะฝะฐ ัะตะณะผะตะฝั ะธ ัะฒะธะดะตัั ะพัะทัะฒั ััะพะน ะบะฐัะตะณะพัะธะธ
- โ AI ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะปะฐััะธัะธัะธััะตั sentiment ะฟัะธ ัะธะฝััะพะฝะธะทะฐัะธะธ

**Story Points:** 3 SP (2-3 ะดะฝั)

---

### US-030: AI Insights ะธ ัะตะบะพะผะตะฝะดะฐัะธะธ
**ะะฐะบ:** ะฒะปะฐะดะตะปะตั ะผะฐะณะฐะทะธะฝะฐ
**ะฏ ัะพัั:** ะฟะพะปััะฐัั ะฐะฒัะพะผะฐัะธัะตัะบะธะต ะธะฝัะฐะนัั ะธะท ะดะฐะฝะฝัั
**ะงัะพะฑั:** ะฝะต ะฟัะพะฟัััะธัั ะฒะฐะถะฝัะต ััะตะฝะดั

**Acceptance Criteria:**
- โ ะะธะถั ัะตะบัะธั "AI Insights" ั 3-5 ะฐะฒัะพะผะฐัะธัะตัะบะธะผะธ ะฝะฐัะพะดะบะฐะผะธ
- โ ะัะธะผะตัั:
  - "โ๏ธ ะะพัั ะฝะตะณะฐัะธะฒะฝัั ะพัะทัะฒะพะฒ ะฝะฐ 25% ะทะฐ ะฟะพัะปะตะดะฝัั ะฝะตะดะตะปั"
  - "โ ะกัะตะดะฝะตะต ะฒัะตะผั ะพัะฒะตัะฐ ัะปัััะธะปะพัั ะฝะฐ 40%"
  - "๐ ะขะพะฟ-3 ะถะฐะปะพะฑั: ะดะพััะฐะฒะบะฐ (12), ัะฐะทะผะตั (8), ะบะฐัะตััะฒะพ (5)"
- โ ะะฐะถะดัะน ะธะฝัะฐะนั ะบะปะธะบะฐะฑะตะปัะฝัะน (ะฒะตะดะตั ะบ ะดะตัะฐะปัะผ)

**Story Points:** 2 SP (1-2 ะดะฝั)

---

## ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### UI Layout

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะฐัะฑะพัะด ะผะฐะณะฐะทะธะฝะฐ "ะะฐะณะฐะทะธะฝ ะ"                       โ
โ  ะะตัะธะพะด: [ะะพัะปะตะดะฝะธะต 30 ะดะฝะตะน โผ]                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโ           โ
โ  โ  4.7 โ   โ โ  1,234   โ โ  87%     โ           โ
โ  โ ะะตะนัะธะฝะณ  โ โ ะัะทัะฒะพะฒ  โ โ ะะฐะบัััะพ  โ           โ
โ  โ +0.2 โ   โ โ +15% โ   โ โ -5% โ    โ           โ
โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ะัะฐัะธะบ ะดะธะฝะฐะผะธะบะธ ะพัะทัะฒะพะฒ                            โ
โ  [ะะธะฝะตะนะฝัะน ะณัะฐัะธะบ: ะบะพะปะธัะตััะฒะพ ะพัะทัะฒะพะฒ ะฟะพ ะดะฝัะผ]      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ะะฐัะฟัะตะดะตะปะตะฝะธะต ัะตะนัะธะฝะณะพะฒ     Sentiment Analysis     โ
โ  [ะััะณะพะฒะฐั ะดะธะฐะณัะฐะผะผะฐ]       [ะกัะพะปะฑัะฐัะฐั ะดะธะฐะณัะฐะผะผะฐ] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  AI Insights                                        โ
โ  โ๏ธ ะะพัั ะฝะตะณะฐัะธะฒะฝัั ะพัะทัะฒะพะฒ ะฝะฐ 25%                 โ
โ  โ ะกัะตะดะฝะตะต ะฒัะตะผั ะพัะฒะตัะฐ ัะปัััะธะปะพัั ะฝะฐ 40%         โ
โ  ๐ ะขะพะฟ-3 ะถะฐะปะพะฑั: ะดะพััะฐะฒะบะฐ (12), ัะฐะทะผะตั (8)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Firestore Schema

```typescript
// stores/{storeId}/analytics/{period}
interface StoreAnalytics {
  storeId: string;
  period: 'day' | 'week' | 'month'; // ะะณัะตะณะฐัะธั ะฟะพ ะฟะตัะธะพะดั

  // Review Metrics
  reviewMetrics: {
    totalReviews: number;
    averageRating: number;
    ratingDistribution: {
      '5': number;
      '4': number;
      '3': number;
      '2': number;
      '1': number;
    };
    sentimentDistribution: {
      positive: number; // %
      neutral: number;
      negative: number;
    };
  };

  // Chat Metrics
  chatMetrics: {
    totalChats: number;
    activeCh ats: number;
    closedChats: number;
    successRate: number; // % ััะฟะตัะฝัั
    averageResponseTime: number; // ะงะฐัั
  };

  // Complaint Metrics
  complaintMetrics: {
    totalComplaints: number;
    autoGenerated: number;
    manualCreated: number;
  };

  // Trends (vs previous period)
  trends: {
    reviewsChange: number; // +15%
    ratingChange: number; // +0.2
    chatSuccessChange: number; // -5%
  };

  // AI Insights
  aiInsights: Array<{
    type: 'warning' | 'success' | 'info';
    title: string;
    description: string;
    actionUrl?: string; // ะัะดะฐ ะฟะตัะตะนัะธ ะฟัะธ ะบะปะธะบะต
  }>;

  // Metadata
  periodStart: Timestamp;
  periodEnd: Timestamp;
  generatedAt: Timestamp;
}
```

### Cloud Function ะดะปั ะฐะณัะตะณะฐัะธะธ

```typescript
// functions/src/scheduled/generate-analytics.ts

import * as functions from 'firebase-functions';
import { firestore } from '../firebase-admin';

export const scheduledAnalyticsGeneration = functions.pubsub
  .schedule('every 24 hours')
  .timeZone('Europe/Moscow')
  .onRun(async (context) => {
    const stores = await firestore.collection('stores').get();

    for (const storeDoc of stores.docs) {
      await generateAnalyticsForStore(storeDoc.id);
    }

    return null;
  });

async function generateAnalyticsForStore(storeId: string) {
  const now = new Date();
  const last30Days = new Date(now);
  last30Days.setDate(last30Days.getDate() - 30);

  const prev30Days = new Date(last30Days);
  prev30Days.setDate(prev30Days.getDate() - 30);

  // 1. ะะพะปััะฐะตะผ ะพัะทัะฒั ะทะฐ ะฟะพัะปะตะดะฝะธะต 30 ะดะฝะตะน
  const reviewsQuery = firestore
    .collectionGroup('reviews')
    .where('storeId', '==', storeId)
    .where('date', '>=', last30Days)
    .where('date', '<=', now);

  const reviewsSnapshot = await reviewsQuery.get();
  const reviews = reviewsSnapshot.docs.map(doc => doc.data());

  // 2. ะกัะธัะฐะตะผ ะผะตััะธะบะธ
  const totalReviews = reviews.length;
  const averageRating = reviews.reduce((sum, r) => sum + r.rating, 0) / totalReviews;

  const ratingDistribution = {
    '5': reviews.filter(r => r.rating === 5).length,
    '4': reviews.filter(r => r.rating === 4).length,
    '3': reviews.filter(r => r.rating === 3).length,
    '2': reviews.filter(r => r.rating === 2).length,
    '1': reviews.filter(r => r.rating === 1).length,
  };

  // 3. Sentiment Analysis (ัะตัะตะท AI)
  const sentimentCounts = { positive: 0, neutral: 0, negative: 0 };
  for (const review of reviews) {
    const sentiment = await analyzeSentiment(review.text);
    sentimentCounts[sentiment]++;
  }

  const sentimentDistribution = {
    positive: (sentimentCounts.positive / totalReviews) * 100,
    neutral: (sentimentCounts.neutral / totalReviews) * 100,
    negative: (sentimentCounts.negative / totalReviews) * 100,
  };

  // 4. ะกัะฐะฒะฝะตะฝะธะต ั ะฟัะตะดัะดััะธะผ ะฟะตัะธะพะดะพะผ
  const prevReviewsSnapshot = await firestore
    .collectionGroup('reviews')
    .where('storeId', '==', storeId)
    .where('date', '>=', prev30Days)
    .where('date', '<', last30Days)
    .get();

  const prevTotalReviews = prevReviewsSnapshot.size;
  const reviewsChange = ((totalReviews - prevTotalReviews) / prevTotalReviews) * 100;

  // 5. AI Insights
  const aiInsights = await generateAIInsights({
    reviewsChange,
    sentimentDistribution,
    topComplaints: extractTopComplaints(reviews),
  });

  // 6. ะกะพััะฐะฝัะตะผ ะฒ Firestore
  await firestore
    .collection('stores').doc(storeId)
    .collection('analytics').doc('month')
    .set({
      storeId,
      period: 'month',
      reviewMetrics: {
        totalReviews,
        averageRating,
        ratingDistribution,
        sentimentDistribution,
      },
      trends: {
        reviewsChange,
      },
      aiInsights,
      periodStart: last30Days,
      periodEnd: now,
      generatedAt: new Date(),
    });
}

async function analyzeSentiment(text: string): Promise<'positive' | 'neutral' | 'negative'> {
  // ะฃะฟัะพัะตะฝะฝะฐั ัะฒัะธััะธะบะฐ (ะผะพะถะฝะพ ะทะฐะผะตะฝะธัั ะฝะฐ AI)
  const positiveWords = ['ัะพัะพัะพ', 'ะพัะปะธัะฝะพ', 'ััะฟะตั', 'ัะตะบะพะผะตะฝะดัั'];
  const negativeWords = ['ะฟะปะพัะพ', 'ัะถะฐัะฝะพ', 'ะฝะต ัะตะบะพะผะตะฝะดัั', 'ัะฐะทะพัะฐัะพะฒะฐะฝ'];

  const lowerText = text.toLowerCase();

  const positiveCount = positiveWords.filter(word => lowerText.includes(word)).length;
  const negativeCount = negativeWords.filter(word => lowerText.includes(word)).length;

  if (positiveCount > negativeCount) return 'positive';
  if (negativeCount > positiveCount) return 'negative';
  return 'neutral';
}

async function generateAIInsights(data: any): Promise<any[]> {
  const insights = [];

  // ะะฝัะฐะนั 1: ะะพัั/ะฟะฐะดะตะฝะธะต ะพัะทัะฒะพะฒ
  if (Math.abs(data.reviewsChange) > 15) {
    insights.push({
      type: data.reviewsChange > 0 ? 'success' : 'warning',
      title: `${data.reviewsChange > 0 ? 'ะะพัั' : 'ะกะฝะธะถะตะฝะธะต'} ะพัะทัะฒะพะฒ ะฝะฐ ${Math.abs(data.reviewsChange).toFixed(0)}%`,
      description: 'ะะพ ััะฐะฒะฝะตะฝะธั ั ะฟัะพัะปัะผ ะผะตัััะตะผ',
      actionUrl: '/reviews',
    });
  }

  // ะะฝัะฐะนั 2: ะะตะณะฐัะธะฒะฝัะต ะพัะทัะฒั
  if (data.sentimentDistribution.negative > 30) {
    insights.push({
      type: 'warning',
      title: `ะััะพะบะฐั ะดะพะปั ะฝะตะณะฐัะธะฒะฝัั ะพัะทัะฒะพะฒ (${data.sentimentDistribution.negative.toFixed(0)}%)`,
      description: 'ะะตะบะพะผะตะฝะดัะตะผ ะฟัะพะฐะฝะฐะปะธะทะธัะพะฒะฐัั ะฟัะธัะธะฝั',
      actionUrl: '/reviews?sentiment=negative',
    });
  }

  // ะะฝัะฐะนั 3: ะขะพะฟ ะถะฐะปะพะฑั
  if (data.topComplaints.length > 0) {
    const top = data.topComplaints[0];
    insights.push({
      type: 'info',
      title: `ะขะพะฟ-1 ะถะฐะปะพะฑะฐ: ${top.category} (${top.count} ัะฟะพะผะธะฝะฐะฝะธะน)`,
      description: 'ะะฑัะฐัะธัะต ะฒะฝะธะผะฐะฝะธะต ะฝะฐ ััะพั ะฐัะฟะตะบั',
      actionUrl: `/reviews?complaint=${top.category}`,
    });
  }

  return insights;
}

function extractTopComplaints(reviews: any[]): Array<{category: string, count: number}> {
  // ะฃะฟัะพัะตะฝะฝะฐั ะบะฐัะตะณะพัะธะทะฐัะธั (ะผะพะถะฝะพ ะทะฐะผะตะฝะธัั ะฝะฐ AI)
  const complaints: Record<string, number> = {};

  reviews.forEach(review => {
    if (review.rating <= 2) {
      const text = review.text.toLowerCase();

      if (text.includes('ะดะพััะฐะฒะบะฐ')) complaints['ะดะพััะฐะฒะบะฐ'] = (complaints['ะดะพััะฐะฒะบะฐ'] || 0) + 1;
      if (text.includes('ัะฐะทะผะตั')) complaints['ัะฐะทะผะตั'] = (complaints['ัะฐะทะผะตั'] || 0) + 1;
      if (text.includes('ะบะฐัะตััะฒะพ')) complaints['ะบะฐัะตััะฒะพ'] = (complaints['ะบะฐัะตััะฒะพ'] || 0) + 1;
      if (text.includes('ัะฟะฐะบะพะฒะบะฐ')) complaints['ัะฟะฐะบะพะฒะบะฐ'] = (complaints['ัะฟะฐะบะพะฒะบะฐ'] || 0) + 1;
    }
  });

  return Object.entries(complaints)
    .map(([category, count]) => ({ category, count }))
    .sort((a, b) => b.count - a.count)
    .slice(0, 3);
}
```

### React Component

```tsx
// src/app/stores/[storeId]/analytics/page.tsx

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { LineChart, PieChart, BarChart } from 'recharts';

export default async function AnalyticsPage({ params }: { params: { storeId: string } }) {
  const analytics = await getAnalyticsForStore(params.storeId);

  return (
    <div className="p-6 space-y-6">
      <h1 className="text-3xl font-bold">ะะฝะฐะปะธัะธะบะฐ</h1>

      {/* KPI Cards */}
      <div className="grid grid-cols-3 gap-4">
        <MetricCard
          title="ะกัะตะดะฝะธะน ัะตะนัะธะฝะณ"
          value={analytics.reviewMetrics.averageRating.toFixed(1)}
          change={analytics.trends.ratingChange}
          icon="โญ"
        />
        <MetricCard
          title="ะัะทัะฒะพะฒ"
          value={analytics.reviewMetrics.totalReviews}
          change={analytics.trends.reviewsChange}
          icon="๐"
        />
        <MetricCard
          title="ะงะฐัะพะฒ ะทะฐะบัััะพ"
          value={`${analytics.chatMetrics.successRate}%`}
          change={analytics.trends.chatSuccessChange}
          icon="โ"
        />
      </div>

      {/* ะัะฐัะธะบะธ */}
      <div className="grid grid-cols-2 gap-4">
        <Card>
          <CardHeader>
            <CardTitle>ะะฐัะฟัะตะดะตะปะตะฝะธะต ัะตะนัะธะฝะณะพะฒ</CardTitle>
          </CardHeader>
          <CardContent>
            <PieChart data={analytics.reviewMetrics.ratingDistribution} />
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>Sentiment Analysis</CardTitle>
          </CardHeader>
          <CardContent>
            <BarChart data={analytics.reviewMetrics.sentimentDistribution} />
          </CardContent>
        </Card>
      </div>

      {/* AI Insights */}
      <Card>
        <CardHeader>
          <CardTitle>AI Insights</CardTitle>
        </CardHeader>
        <CardContent>
          {analytics.aiInsights.map((insight, i) => (
            <div key={i} className="p-3 border rounded mb-2">
              {insight.type === 'warning' && 'โ๏ธ'}
              {insight.type === 'success' && 'โ'}
              {insight.type === 'info' && '๐'}
              <strong>{insight.title}</strong>
              <p className="text-sm text-muted-foreground">{insight.description}</p>
            </div>
          ))}
        </CardContent>
      </Card>
    </div>
  );
}
```

---

## ะะตััะธะบะธ ััะฟะตัะฐ

**KPIs:**
- ๐ 80%+ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะทะฐัะพะดัั ะฒ Analytics ัะพัั ะฑั 1 ัะฐะท/ะฝะตะดะตะปั
- โฑ๏ธ ะญะบะพะฝะพะผะธั ะฒัะตะผะตะฝะธ: 1 ัะฐั/ะฝะตะดะตะปั (ะฝะต ะฝัะถะตะฝ Excel)
- ๐ User satisfaction: +25% (feature surveys)
- ๐ผ ะกะฝะธะถะตะฝะธะต churn ะฝะฐ 10% (ะดะฐะฝะฝัะต ะดะปั ะฟัะธะฝััะธั ัะตัะตะฝะธะน)

**ะะพะฝะธัะพัะธะฝะณ:**
- Page views ะฝะฐ /analytics
- ะัะตะผั ะฝะฐ ัััะฐะฝะธัะต (engagement)
- ะะปะธะบะธ ะฝะฐ AI Insights

---

## ะะฐะฒะธัะธะผะพััะธ

**ะะฝะตัะฝะธะต:**
- Recharts ะดะปั ะณัะฐัะธะบะพะฒ
- Deepseek API ะดะปั sentiment analysis (ะพะฟัะธะพะฝะฐะปัะฝะพ)

**ะะฝัััะตะฝะฝะธะต:**
- ะกััะตััะฒัััะธะต ะบะพะปะปะตะบัะธะธ reviews, chats
- Cloud Functions ะดะปั ะฐะณัะตะณะฐัะธะธ

---

## Risks & Mitigation

| ะะธัะบ | ะะตัะพััะฝะพััั | ะะปะธัะฝะธะต | ะะธัะธะณะฐัะธั |
|------|-------------|---------|-----------|
| ะะพะปะณะฐั ะณะตะฝะตัะฐัะธั ะฐะฝะฐะปะธัะธะบะธ | ะกัะตะดะฝัั | ะกัะตะดะฝะตะต | Pre-compute ะตะถะตะดะฝะตะฒะฝะพ, ะบัั ะฒ Firestore |
| Firestore read costs | ะััะพะบะฐั | ะกัะตะดะฝะตะต | Collection Group Queries + ะปะธะผะธั ะฝะฐ 30k ะดะพะบัะผะตะฝัะพะฒ |
| ะะตัะพัะฝัะน sentiment | ะกัะตะดะฝัั | ะะธะทะบะพะต | ะัะฟะพะปัะทะพะฒะฐัั AI (Deepseek) ะฒะผะตััะพ ัะฒัะธััะธะบ |

---

## Timeline

**Week 1:**
- Day 1-3: Firestore schema + Cloud Function ะฐะณัะตะณะฐัะธะธ
- Day 4-5: UI ะบะพะผะฟะพะฝะตะฝัั (KPI cards, ะณัะฐัะธะบะธ)

**Week 2:**
- Day 1-2: Sentiment Analysis ัะตัะตะท AI
- Day 3-4: AI Insights ะณะตะฝะตัะฐัะธั
- Day 5: ะขะตััะธัะพะฒะฐะฝะธะต + rollout

---

## ะะพะฝะตัะธะทะฐัะธั

**ะะปะธัะฝะธะต ะฝะฐ $100/ะผะตััั ะฟะพะดะฟะธัะบั:**
- ะะฝะฐะปะธัะธะบะฐ = **ะพะฑัะทะฐัะตะปัะฝะฐั ััะฝะบัะธั** ะดะปั Full ะฒะตััะธะธ
- ะะพะฝะบััะตะฝัั ะฟัะตะดะปะฐะณะฐัั ัะพะปัะบะพ ะฑะฐะทะพะฒัั ััะฐัะธััะธะบั
- AI Insights = **ัะฝะธะบะฐะปัะฝัะน ะดะธััะตัะตะฝัะธะฐัะพั**

**Value Proposition:**
- "ะัะธะฝะธะผะฐะนัะต ัะตัะตะฝะธั ะฝะฐ ะพัะฝะพะฒะต ะดะฐะฝะฝัั, ะฐ ะฝะต ะดะพะณะฐะดะพะบ"
- "AI ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฝะฐัะพะดะธั ะฟัะพะฑะปะตะผั ะทะฐ ะฒะฐั"

---

## Definition of Done

- โ KPI cards ั ััะตะฝะดะฐะผะธ (vs ะฟัะพัะปัะน ะฟะตัะธะพะด)
- โ ะัะฐัะธะบะธ: ะดะธะฝะฐะผะธะบะฐ ะพัะทัะฒะพะฒ, ัะฐัะฟัะตะดะตะปะตะฝะธะต ัะตะนัะธะฝะณะพะฒ, sentiment
- โ Sentiment Analysis ัะตัะตะท AI
- โ AI Insights ั 3-5 ะฐะฒัะพะผะฐัะธัะตัะบะธะผะธ ะฝะฐัะพะดะบะฐะผะธ
- โ Cloud Function ะดะปั ะตะถะตะดะฝะตะฒะฝะพะน ะณะตะฝะตัะฐัะธะธ ะฐะฝะฐะปะธัะธะบะธ
- โ ะัะฑะพั ะฟะตัะธะพะดะฐ: 7ะด, 30ะด, 90ะด, ะณะพะด
- โ ะัะพัะตััะธัะพะฒะฐะฝะพ ะฝะฐ 5+ ะผะฐะณะฐะทะธะฝะฐั
- โ ะะพะบัะผะตะฝัะฐัะธั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

---

**ะกะพะทะดะฐะฝะพ:** 30 ะดะตะบะฐะฑัั 2024
**ะะฑะฝะพะฒะปะตะฝะพ:** 30 ะดะตะบะฐะฑัั 2024
**ะกะปะตะดัััะธะน ัะตะฒัั:** Sprint Planning Q2 2025
