# Task Management Center - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2026-01-20
**–°—Ç–∞—Ç—É—Å**: MVP —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –≥–æ—Ç–æ–≤ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é
**–í–µ—Ä—Å–∏—è**: 1.0

---

## üìã –û–±–∑–æ—Ä

Task Management Center ‚Äî —Ü–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–≤ –Ω–∞ Wildberries. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å –æ—Ç–∑—ã–≤–∞–º–∏, –¥–∏–∞–ª–æ–≥–∞–º–∏, –≤–æ–ø—Ä–æ—Å–∞–º–∏
- –£–ø—Ä–∞–≤–ª—è—Ç—å –∂–∞–ª–æ–±–∞–º–∏ (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –æ—Ç–ø—Ä–∞–≤–∫–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞)
- –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å—Ä–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ —Ä–∞–∑–ª–∏—á–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º
- –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å KPI –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π UI (—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, —Ñ–∏–ª—å—Ç—Ä—ã, –ø–æ–∏—Å–∫, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ API (—Å–æ–∑–¥–∞–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á)
- PostgreSQL backend (—Ç–∞–±–ª–∏—Ü–∞ `manager_tasks`)
- KPI –¥–∞—à–±–æ—Ä–¥ (–≤—Å–µ–≥–æ –∑–∞–¥–∞—á, –∂–∞–ª–æ–±—ã, –¥–∏–∞–ª–æ–≥–∏, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ)
- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á inline

‚ùå **–ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ö–æ–ª–æ–Ω–∫–∞ "–¢–æ–≤–∞—Ä" (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç placeholder "‚Äî")
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–¥–∞—á–∏ (–∫–ª–∏–∫ –ø–æ –∑–∞–¥–∞—á–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ CRON jobs
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—Ç–æ–≤
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è (–ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –∑–∞–¥–∞—á)
- Bulk actions (–º–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤)

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **UI**: React —Å inline styles (–≥–æ—Ç–æ–≤–æ –∫ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ Tailwind CSS)
- **Icons**: lucide-react
- **State Management**: useState, useEffect (–ª–æ–∫–∞–ª—å–Ω—ã–π state)

### Backend
- **Database**: PostgreSQL (Yandex.Cloud Managed PostgreSQL)
- **API**: Next.js API Routes
- **ORM/Query Builder**: –ù–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ pg
- **Database Client**: `src/db/client.ts` (pg pool)

### UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `src/app/tasks/page.tsx` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
- `src/components/tasks/TaskKPICard.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∏ KPI
- `src/components/tasks/CreateTaskModal.tsx` ‚Äî –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏

---

## üóÑ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã `manager_tasks`

```sql
CREATE TABLE manager_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  store_id UUID NOT NULL REFERENCES stores(id) ON DELETE CASCADE,

  -- –°–≤—è–∑–∞–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å
  entity_type TEXT NOT NULL CHECK (entity_type IN ('review', 'chat', 'question')),
  entity_id UUID NOT NULL,

  -- –î–µ–π—Å—Ç–≤–∏–µ –∏ —Å—Ç–∞—Ç—É—Å
  action TEXT NOT NULL CHECK (action IN (
    'generate_complaint',
    'submit_complaint',
    'check_complaint',
    'reply_to_chat',
    'reply_to_question'
  )),
  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN (
    'pending',
    'in_progress',
    'completed',
    'cancelled'
  )),
  priority TEXT NOT NULL DEFAULT 'normal' CHECK (priority IN (
    'low',
    'normal',
    'high',
    'urgent'
  )),

  -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  title TEXT NOT NULL,
  description TEXT,
  notes TEXT,

  -- –î–∞—Ç—ã
  due_date TIMESTAMP WITH TIME ZONE,
  completed_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),

  -- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
  INDEX idx_manager_tasks_user_status (user_id, status),
  INDEX idx_manager_tasks_store (store_id),
  INDEX idx_manager_tasks_entity (entity_type, entity_id),
  INDEX idx_manager_tasks_due_date (due_date)
);
```

### –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

**entity_type** ‚Äî —Ç–∏–ø —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏:
- `review` ‚Äî –∑–∞–¥–∞—á–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –æ—Ç–∑—ã–≤–æ–º
- `chat` ‚Äî –∑–∞–¥–∞—á–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –¥–∏–∞–ª–æ–≥–æ–º
- `question` ‚Äî –∑–∞–¥–∞—á–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –≤–æ–ø—Ä–æ—Å–æ–º –ø–æ–∫—É–ø–∞—Ç–µ–ª—è

**action** ‚Äî —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è:
- `generate_complaint` ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –∂–∞–ª–æ–±—ã
- `submit_complaint` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∂–∞–ª–æ–±—É –≤ WB
- `check_complaint` ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∂–∞–ª–æ–±—ã
- `reply_to_chat` ‚Äî –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –¥–∏–∞–ª–æ–≥ —Å –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º
- `reply_to_question` ‚Äî –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ–∫—É–ø–∞—Ç–µ–ª—è

**status** ‚Äî —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `in_progress` ‚Äî –≤ —Ä–∞–±–æ—Ç–µ
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–æ

**priority** ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- `low` ‚Äî –Ω–∏–∑–∫–∏–π
- `normal` ‚Äî —Å—Ä–µ–¥–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `high` ‚Äî –≤—ã—Å–æ–∫–∏–π
- `urgent` ‚Äî —Å—Ä–æ—á–Ω–æ

---

## üîå API Routes

### GET `/api/tasks`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

**Headers**:
```
Authorization: Bearer {API_KEY}
```

**Query Parameters**:
- `storeId` (optional) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –º–∞–≥–∞–∑–∏–Ω—É
- `status` (optional) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (`pending`, `in_progress`, `completed`, `cancelled`)
- `entityType` (optional) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å—É—â–Ω–æ—Å—Ç–∏ (`review`, `chat`, `question`)
- `action` (optional) ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –¥–µ–π—Å—Ç–≤–∏—é
- `limit` (optional, default: 100) ‚Äî –ª–∏–º–∏—Ç –∑–∞–ø–∏—Å–µ–π
- `offset` (optional, default: 0) ‚Äî —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**Response**:
```json
{
  "success": true,
  "tasks": [
    {
      "id": "uuid",
      "user_id": "uuid",
      "store_id": "uuid",
      "entity_type": "review",
      "entity_id": "uuid",
      "action": "generate_complaint",
      "status": "pending",
      "priority": "high",
      "title": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –æ—Ç–∑—ã–≤ 1‚òÖ",
      "description": "–û—Ç–∑—ã–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è '–ò–≤–∞–Ω –ü.'",
      "notes": null,
      "due_date": "2026-01-21T10:00:00Z",
      "completed_at": null,
      "created_at": "2026-01-20T12:00:00Z",
      "updated_at": "2026-01-20T12:00:00Z"
    }
  ],
  "count": 1
}
```

### POST `/api/tasks`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É

**Headers**:
```
Authorization: Bearer {API_KEY}
Content-Type: application/json
```

**Body**:
```json
{
  "store_id": "uuid",
  "entity_type": "review",
  "entity_id": "uuid",
  "action": "generate_complaint",
  "title": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –æ—Ç–∑—ã–≤ 1‚òÖ",
  "description": "–û—Ç–∑—ã–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è '–ò–≤–∞–Ω –ü.'",
  "priority": "high",
  "due_date": "2026-01-21T10:00:00Z"
}
```

**Response**:
```json
{
  "success": true,
  "task": {
    "id": "uuid",
    "status": "pending",
    ...
  }
}
```

### PATCH `/api/tasks/[taskId]`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É (–∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —Å—Ä–æ–∫–∏)

**Headers**:
```
Authorization: Bearer {API_KEY}
Content-Type: application/json
```

**Body**:
```json
{
  "status": "completed",
  "notes": "–ñ–∞–ª–æ–±–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞"
}
```

**Response**:
```json
{
  "success": true,
  "task": {
    "id": "uuid",
    "status": "completed",
    "completed_at": "2026-01-20T14:30:00Z",
    ...
  }
}
```

### GET `/api/tasks/stats`

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∑–∞–¥–∞—á–∞–º

**Headers**:
```
Authorization: Bearer {API_KEY}
```

**Response**:
```json
{
  "success": true,
  "stats": {
    "totalTasks": 45,
    "pendingTasks": 12,
    "inProgressTasks": 8,
    "overdueTasks": 3,
    "complaintsTasks": 25,
    "chatsTasks": 20
  }
}
```

---

## üé® Frontend –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: `src/app/tasks/page.tsx`

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**:
1. **Header —Å –ø–æ–∏—Å–∫–æ–º** ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ "üìã –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á (X)" + search input
2. **KPI Cards** ‚Äî 4 –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
3. **Filters + Create Button** ‚Äî —Ñ–∏–ª—å—Ç—Ä—ã (–º–∞–≥–∞–∑–∏–Ω, —Å—Ç–∞—Ç—É—Å, –¥–µ–π—Å—Ç–≤–∏–µ, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞) + –∫–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É"
4. **Tasks Table** ‚Äî —Ç–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
   - –ó–∞–¥–∞—á–∞ (title + description)
   - –ú–∞–≥–∞–∑–∏–Ω (store name)
   - –¢–æ–≤–∞—Ä (placeholder "‚Äî", –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
   - –î–µ–π—Å—Ç–≤–∏–µ (badge —Å —Ü–≤–µ—Ç–æ–º)
   - –°—Ç–∞—Ç—É—Å (badge —Å –∏–∫–æ–Ω–∫–æ–π)
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Ü–≤–µ—Ç–Ω–æ–π —Ç–µ–∫—Å—Ç)
   - –°—Ä–æ–∫ (–¥–∞—Ç–∞ + –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ—Å—Ä–æ—á–∫–∏)
   - –î–µ–π—Å—Ç–≤–∏—è (–∫–Ω–æ–ø–∫–∏ "–ù–∞—á–∞—Ç—å" / "–ó–∞–≤–µ—Ä—à–∏—Ç—å")

**State —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
```typescript
const [tasks, setTasks] = useState<Task[]>([]);
const [stats, setStats] = useState<TaskStats | null>(null);
const [stores, setStores] = useState<Store[]>([]);
const [isLoading, setIsLoading] = useState(true);
const [filterStatus, setFilterStatus] = useState<string>('all');
const [filterAction, setFilterAction] = useState<string>('all');
const [filterStore, setFilterStore] = useState<string>('all');
const [sortBy, setSortBy] = useState<string>('created_desc');
const [searchQuery, setSearchQuery] = useState<string>('');
const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);
```

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
const fetchData = async () => {
  const params = new URLSearchParams();
  if (filterStatus !== 'all') params.append('status', filterStatus);
  if (filterAction !== 'all') params.append('action', filterAction);
  if (filterStore !== 'all') params.append('storeId', filterStore);

  const tasksRes = await fetch(`/api/tasks?${params}`, {
    headers: { Authorization: `Bearer ${apiKey}` },
  });
  const tasksData = await tasksRes.json();

  // Client-side search filtering
  let filteredTasks = tasksData.tasks;
  if (searchQuery.trim()) {
    const query = searchQuery.toLowerCase();
    filteredTasks = filteredTasks.filter((task: Task) =>
      task.title.toLowerCase().includes(query) ||
      task.description?.toLowerCase().includes(query)
    );
  }

  const sortedTasks = sortTasks(filteredTasks, sortBy);
  setTasks(sortedTasks);
};

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏
const updateTaskStatus = async (taskId: string, status: Task['status']) => {
  await fetch(`/api/tasks/${taskId}`, {
    method: 'PATCH',
    headers: {
      Authorization: `Bearer ${apiKey}`,
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ status }),
  });

  if (status === 'completed') {
    // Auto-set completed_at on backend
  }

  fetchData(); // Refresh data
};
```

### –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: `src/components/tasks/CreateTaskModal.tsx`

**Props**:
```typescript
interface CreateTaskModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSuccess: () => void;
  apiKey: string;
}
```

**–§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏**:
- Store selection (dropdown)
- Action type (dropdown)
- Title (text input)
- Description (textarea)
- Priority (dropdown)
- Due date (date picker)

**–í–∞–ª–∏–¥–∞—Ü–∏—è**:
- Store, action, title ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
- Due date ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ
- Description ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ

### KPI –∫–∞—Ä—Ç–æ—á–∫–∞: `src/components/tasks/TaskKPICard.tsx`

**Props**:
```typescript
interface TaskKPICardProps {
  icon: React.ComponentType<any>;
  label: string;
  value: number;
  bgColor: string;
  iconColor: string;
}
```

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
```tsx
<TaskKPICard
  icon={ListTodo}
  label="–í—Å–µ–≥–æ –∑–∞–¥–∞—á"
  value={stats.totalTasks}
  bgColor="#EFF6FF"
  iconColor="#3B82F6"
/>
```

---

## üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

### –§–∏–ª—å—Ç—Ä—ã

**1. –§–∏–ª—å—Ç—Ä –ø–æ –º–∞–≥–∞–∑–∏–Ω—É**:
- `all` ‚Äî –≤—Å–µ –º–∞–≥–∞–∑–∏–Ω—ã
- `{storeId}` ‚Äî –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω

**2. –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É**:
- `all` ‚Äî –≤—Å–µ —Å—Ç–∞—Ç—É—Å—ã
- `pending` ‚Äî –æ–∂–∏–¥–∞–µ—Ç
- `in_progress` ‚Äî –≤ —Ä–∞–±–æ—Ç–µ
- `completed` ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- `cancelled` ‚Äî –æ—Ç–º–µ–Ω–µ–Ω–æ

**3. –§–∏–ª—å—Ç—Ä –ø–æ –¥–µ–π—Å—Ç–≤–∏—é**:
- `all` ‚Äî –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è
- `generate_complaint` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∂–∞–ª–æ–±—ã
- `submit_complaint` ‚Äî –ø–æ–¥–∞—á–∞ –∂–∞–ª–æ–±—ã
- `check_complaint` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∂–∞–ª–æ–±—ã
- `reply_to_chat` ‚Äî –æ—Ç–≤–µ—Ç –Ω–∞ –¥–∏–∞–ª–æ–≥

### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞

- `created_desc` ‚Äî –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ) ‚Äî **–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**
- `created_asc` ‚Äî –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (—Å—Ç–∞—Ä—ã–µ –ø–µ—Ä–≤—ã–µ)
- `priority_desc` ‚Äî –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (—Å—Ä–æ—á–Ω—ã–µ –ø–µ—Ä–≤—ã–µ)
- `priority_asc` ‚Äî –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (–Ω–∏–∑–∫–∏–µ –ø–µ—Ä–≤—ã–µ)
- `due_date_asc` ‚Äî –ø–æ —Å—Ä–æ–∫—É (–±–ª–∏–∂–∞–π—à–∏–µ –ø–µ—Ä–≤—ã–µ)
- `due_date_desc` ‚Äî –ø–æ —Å—Ä–æ–∫—É (–¥–∞–ª—å–Ω–∏–µ –ø–µ—Ä–≤—ã–µ)

### –ü–æ–∏—Å–∫

Client-side –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—è–º:
- `task.title` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞–¥–∞—á–∏
- `task.description` ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

**–ü—Ä–∏–º–µ—Ä**: –í–≤–æ–¥ "–∂–∞–ª–æ–±–∞" –Ω–∞–π–¥–µ—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ —Å "–∂–∞–ª–æ–±–∞" –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–∏.

---

## üöß –ù–µ–¥–æ—Ä–∞–±–æ—Ç–∫–∏ –∏ TODO

### 1. –ö–æ–ª–æ–Ω–∫–∞ "–¢–æ–≤–∞—Ä" (Priority: P2, LOW)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "‚Äî" (placeholder)

**–ü—Ä–æ–±–ª–µ–º–∞**:
- –í —Ç–∞–±–ª–∏—Ü–µ `manager_tasks` –Ω–µ—Ç –ø–æ–ª—è `product_id`
- –¢–æ–≤–∞—Ä –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ —Å–≤—è–∑–∞–Ω–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å (review/chat ‚Üí product_id)

**–†–µ—à–µ–Ω–∏–µ**:
```typescript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –î–æ–±–∞–≤–∏—Ç—å product_id –≤ manager_tasks (–¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)
ALTER TABLE manager_tasks ADD COLUMN product_id UUID REFERENCES products(id);

// –í–∞—Ä–∏–∞–Ω—Ç 2: JOIN —á–µ—Ä–µ–∑ entity_id
const getTasksWithProducts = async (userId: string) => {
  const sql = `
    SELECT
      t.*,
      p.name as product_name,
      p.vendor_code as product_vendor_code
    FROM manager_tasks t
    LEFT JOIN reviews r ON t.entity_type = 'review' AND t.entity_id = r.id
    LEFT JOIN chats c ON t.entity_type = 'chat' AND t.entity_id = c.id
    LEFT JOIN products p ON (r.product_id = p.id OR c.product_nm_id = p.wb_product_id)
    WHERE t.user_id = $1
  `;
  // ...
};
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –í–∞—Ä–∏–∞–Ω—Ç 2 (JOIN) ‚Äî –Ω–µ –¥—É–±–ª–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ, –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ –∏—Å—Ç–∏–Ω—ã.

### 2. –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–¥–∞—á–∏ (Priority: P1, MEDIUM)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –ö–ª–∏–∫ –ø–æ –∑–∞–¥–∞—á–µ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç

**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/tasks/[taskId]`
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–¥–∞—á–µ
- –°–≤—è–∑–∞–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å (–æ—Ç–∑—ã–≤/—á–∞—Ç/–≤–æ–ø—Ä–æ—Å) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä—è–º–æ –∏–∑ –∑–∞–¥–∞—á–∏

**–ü—Ä–∏–º–µ—Ä**:
```tsx
// src/app/tasks/[taskId]/page.tsx
export default function TaskDetailPage({ params }: { params: { taskId: string } }) {
  const [task, setTask] = useState<Task | null>(null);
  const [entity, setEntity] = useState<Review | Chat | Question | null>(null);

  useEffect(() => {
    // Fetch task
    fetch(`/api/tasks/${params.taskId}`, { headers: { Authorization: `Bearer ${apiKey}` } })
      .then(res => res.json())
      .then(data => setTask(data.task));

    // Fetch related entity
    if (task?.entity_type === 'review') {
      fetch(`/api/reviews/${task.entity_id}`, ...)
        .then(res => res.json())
        .then(data => setEntity(data.review));
    }
  }, [params.taskId]);

  return (
    <div>
      <h1>{task?.title}</h1>
      <p>{task?.description}</p>

      {/* Related entity preview */}
      {task?.entity_type === 'review' && entity && (
        <ReviewPreview review={entity} />
      )}

      {/* Action buttons */}
      {task?.action === 'generate_complaint' && (
        <button onClick={generateComplaint}>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∂–∞–ª–æ–±—É</button>
      )}
    </div>
  );
}
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRON jobs (Priority: P0, HIGH)

**–ü—Ä–æ–±–ª–µ–º–∞**: CRON –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∂–∞–ª–æ–±—ã, –Ω–æ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–†–µ—à–µ–Ω–∏–µ**: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `src/lib/cron-jobs.ts`

```typescript
// –í —Ñ—É–Ω–∫—Ü–∏–∏ generateComplaintsForStore()
async function generateComplaintsForStore(storeId: string, storeName: string) {
  // ... existing code ...

  const result = await response.json();

  // NEW: Create tasks for generated complaints
  for (const generated of result.generated) {
    await dbHelpers.createManagerTask({
      user_id: userId, // –ü–æ–ª—É—á–∏—Ç—å –∏–∑ store owner_id
      store_id: storeId,
      entity_type: 'review',
      entity_id: generated.review_id,
      action: 'check_complaint', // –∏–ª–∏ 'submit_complaint'
      title: `–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –æ—Ç–∑—ã–≤ ${generated.rating}‚òÖ`,
      description: `–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∂–∞–ª–æ–±–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ ${generated.product_name}`,
      priority: 'high',
      status: 'pending',
      due_date: new Date(Date.now() + 24 * 60 * 60 * 1000), // +24 hours
      notes: null,
    });
  }

  return { generated: result.generated.length, ... };
}
```

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤ (Priority: P0, HIGH)

**–ì–¥–µ**: –ü—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ `/api/stores/[storeId]/chats/classify-all`

**–†–µ—à–µ–Ω–∏–µ**:
```typescript
// –í src/app/api/stores/[storeId]/chats/classify-all/route.ts

for (const chat of chats) {
  const classification = await classifyChat(chat);

  // Update chat tag
  await dbHelpers.updateChat(chat.id, { tag: classification.tag });

  // NEW: Create task if chat needs reply
  if (classification.tag === 'active' || classification.tag === 'unsuccessful') {
    await dbHelpers.createManagerTask({
      user_id: settings.id,
      store_id: storeId,
      entity_type: 'chat',
      entity_id: chat.id,
      action: 'reply_to_chat',
      title: `–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –¥–∏–∞–ª–æ–≥ —Å ${chat.client_name}`,
      description: chat.last_message_text || '',
      priority: classification.tag === 'active' ? 'high' : 'normal',
      status: 'pending',
      due_date: new Date(Date.now() + 12 * 60 * 60 * 1000), // +12 hours
      notes: null,
    });
  }
}
```

### 5. –ü–∞–≥–∏–Ω–∞—Ü–∏—è (Priority: P1, MEDIUM)

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ 100+ –∑–∞–¥–∞—á —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ**:
```typescript
// Frontend
const [page, setPage] = useState(0);
const LIMIT = 50;

const fetchData = async () => {
  const params = new URLSearchParams();
  params.append('limit', LIMIT.toString());
  params.append('offset', (page * LIMIT).toString());
  // ... filters ...

  const tasksRes = await fetch(`/api/tasks?${params}`, ...);
  // ...
};

// UI
<div className="pagination">
  <button onClick={() => setPage(p => Math.max(0, p - 1))} disabled={page === 0}>
    –ü—Ä–µ–¥—ã–¥—É—â–∞—è
  </button>
  <span>–°—Ç—Ä–∞–Ω–∏—Ü–∞ {page + 1}</span>
  <button onClick={() => setPage(p => p + 1)} disabled={tasks.length < LIMIT}>
    –°–ª–µ–¥—É—é—â–∞—è
  </button>
</div>
```

### 6. Bulk actions (Priority: P2, LOW)

**–ß—Ç–æ –Ω—É–∂–Ω–æ**:
- Checkbox –¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–¥–∞—á
- –î–µ–π—Å—Ç–≤–∏—è: "–û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏", "–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç", "–£–¥–∞–ª–∏—Ç—å"

**–ü—Ä–∏–º–µ—Ä**:
```typescript
const [selectedTasks, setSelectedTasks] = useState<string[]>([]);

const bulkUpdateStatus = async (status: TaskStatus) => {
  await Promise.all(
    selectedTasks.map(taskId =>
      fetch(`/api/tasks/${taskId}`, {
        method: 'PATCH',
        headers: { ... },
        body: JSON.stringify({ status }),
      })
    )
  );

  setSelectedTasks([]);
  fetchData();
};
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

### –§–∞–∑–∞ 1: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)
**–¶–µ–ª—å**: 100% –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á

1. ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRON jobs**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∂–∞–ª–æ–±
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: HIGH, Due date: +24h

2. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∑ –¥–∏–∞–ª–æ–≥–æ–≤**
   - –ü—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—Ç–∞ –∫–∞–∫ "active" ‚Üí —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É "reply_to_chat"
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–≥–∞ —á–∞—Ç–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–µ–Ω–µ–¥–∂–µ—Ä –≤–∏–¥–∏—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è

### –§–∞–∑–∞ 2: –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (1 –Ω–µ–¥–µ–ª—è)
**–¶–µ–ª—å**: –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∑–∞–¥–∞—á–µ–π

3. ‚úÖ **Task Detail Page**
   - –ú–∞—Ä—à—Ä—É—Ç `/tasks/[taskId]`
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (–æ—Ç–∑—ã–≤/—á–∞—Ç/–≤–æ–ø—Ä–æ—Å)
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä—è–º–æ –∏–∑ –∑–∞–¥–∞—á–∏
   - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞—á—É –±–µ–∑ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏

### –§–∞–∑–∞ 3: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 –Ω–µ–¥–µ–ª–∏)
**–¶–µ–ª—å**: –†–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º –æ–±—ä–µ–º–æ–º –∑–∞–¥–∞—á

4. ‚úÖ **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**
   - Limit 50 –∑–∞–¥–∞—á –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - "–ü—Ä–µ–¥—ã–¥—É—â–∞—è" / "–°–ª–µ–¥—É—é—â–∞—è" –∫–Ω–æ–ø–∫–∏

5. ‚úÖ **Bulk actions**
   - Checkbox –¥–ª—è –≤—ã–±–æ—Ä–∞ –∑–∞–¥–∞—á
   - –ú–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

6. ‚úÖ **–ö–æ–ª–æ–Ω–∫–∞ "–¢–æ–≤–∞—Ä"**
   - JOIN —á–µ—Ä–µ–∑ entity_id ‚Üí reviews/chats ‚Üí products
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –∞—Ä—Ç–∏–∫—É–ª–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å 500+ –∑–∞–¥–∞—á–∞–º–∏

### –§–∞–∑–∞ 4: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
**–¶–µ–ª—å**: –ù–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –≤–∞–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏

7. ‚úÖ **Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   - –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ä–æ—á–Ω–æ–π –∑–∞–¥–∞—á–∏

8. ‚úÖ **Dashboard badge**
   - –ö—Ä–∞—Å–Ω—ã–π badge —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

---

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤—Ä—É—á–Ω—É—é

```bash
# –û—Ç–∫—Ä—ã—Ç—å http://localhost:9002/tasks
# –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É"
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É:
#   - Store: –≤—ã–±—Ä–∞—Ç—å –º–∞–≥–∞–∑–∏–Ω
#   - Action: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∂–∞–ª–æ–±—ã"
#   - Title: "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞"
#   - Priority: "–í—ã—Å–æ–∫–∏–π"
# –ù–∞–∂–∞—Ç—å "–°–æ–∑–¥–∞—Ç—å"
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤

```bash
# –í—ã–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä "–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç"
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ pending –∑–∞–¥–∞—á–∏

# –í—ã–±—Ä–∞—Ç—å "–î–µ–π—Å—Ç–≤–∏–µ: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∂–∞–ª–æ–±—ã"
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ generate_complaint –∑–∞–¥–∞—á–∏

# –í–≤–µ—Å—Ç–∏ –≤ –ø–æ–∏—Å–∫ "–∂–∞–ª–æ–±–∞"
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ title/description
```

### 3. –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ù–∞–π—Ç–∏ –∑–∞–¥–∞—á—É —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–û–∂–∏–¥–∞–µ—Ç"
# –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å"
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ "–í —Ä–∞–±–æ—Ç–µ"
# –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ó–∞–≤–µ—Ä—à–∏—Ç—å"
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è –Ω–∞ "–ó–∞–≤–µ—Ä—à–µ–Ω–æ"
```

### 4. KPI –¥–∞—à–±–æ—Ä–¥

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á —Å —Ä–∞–∑–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏ –∏ actions
# –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ KPI –∫–∞—Ä—Ç–æ—á–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è:
#   - "–í—Å–µ–≥–æ –∑–∞–¥–∞—á" = COUNT(*)
#   - "–ñ–∞–ª–æ–±—ã" = COUNT(action IN ('generate_complaint', 'submit_complaint', 'check_complaint'))
#   - "–î–∏–∞–ª–æ–≥–∏" = COUNT(action = 'reply_to_chat')
#   - "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ" = COUNT(due_date < NOW() AND status NOT IN ('completed', 'cancelled'))
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```typescript
import * as dbHelpers from '@/db/helpers';

async function createTaskForReview(reviewId: string, storeId: string, userId: string) {
  const task = await dbHelpers.createManagerTask({
    user_id: userId,
    store_id: storeId,
    entity_type: 'review',
    entity_id: reviewId,
    action: 'generate_complaint',
    title: '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∂–∞–ª–æ–±—É –Ω–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–∑—ã–≤',
    description: '–û—Ç–∑—ã–≤ 1‚òÖ –æ—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª—è',
    priority: 'high',
    status: 'pending',
    due_date: new Date(Date.now() + 24 * 60 * 60 * 1000), // +24 hours
    notes: null,
  });

  console.log('Task created:', task.id);
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

```typescript
import * as dbHelpers from '@/db/helpers';

async function getPendingComplaintTasks(userId: string, storeId: string) {
  const tasks = await dbHelpers.getManagerTasks(userId, {
    storeId,
    status: 'pending',
    action: 'generate_complaint',
    limit: 50,
    offset: 0,
  });

  return tasks;
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

```typescript
import * as dbHelpers from '@/db/helpers';

async function completeTask(taskId: string) {
  const updatedTask = await dbHelpers.updateManagerTask(taskId, {
    status: 'completed',
    notes: '–ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ',
    // completed_at –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤ NOW() –Ω–∞ backend
  });

  return updatedTask;
}
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Environment Variables

```bash
# Database
POSTGRES_URL="postgresql://user:password@host:port/database"

# API Key –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
NEXT_PUBLIC_API_KEY="wbrm_u1512gxsgp1nt1n31fmsj1d31o51jue"

# Base URL –¥–ª—è CRON jobs
NEXT_PUBLIC_BASE_URL="http://localhost:9002"

# Node environment
NODE_ENV="development" # –∏–ª–∏ "production"
```

### Database Migrations

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `manager_tasks`:

```sql
-- Run this SQL in your PostgreSQL database
-- (Already exists, this is for reference only)

CREATE TABLE manager_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  store_id UUID NOT NULL REFERENCES stores(id) ON DELETE CASCADE,
  entity_type TEXT NOT NULL CHECK (entity_type IN ('review', 'chat', 'question')),
  entity_id UUID NOT NULL,
  action TEXT NOT NULL CHECK (action IN ('generate_complaint', 'submit_complaint', 'check_complaint', 'reply_to_chat', 'reply_to_question')),
  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'in_progress', 'completed', 'cancelled')),
  priority TEXT NOT NULL DEFAULT 'normal' CHECK (priority IN ('low', 'normal', 'high', 'urgent')),
  title TEXT NOT NULL,
  description TEXT,
  notes TEXT,
  due_date TIMESTAMP WITH TIME ZONE,
  completed_at TIMESTAMP WITH TIME ZONE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_manager_tasks_user_status ON manager_tasks(user_id, status);
CREATE INDEX idx_manager_tasks_store ON manager_tasks(store_id);
CREATE INDEX idx_manager_tasks_entity ON manager_tasks(entity_type, entity_id);
CREATE INDEX idx_manager_tasks_due_date ON manager_tasks(due_date);
```

---

## üêõ Troubleshooting

### –ó–∞–¥–∞—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü—É—Å—Ç–æ–π —ç–∫—Ä–∞–Ω –∏–ª–∏ "–ó–∞–≥—Ä—É–∑–∫–∞..." –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API key –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `localStorage.getItem('api_key')`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å console –≤ DevTools –Ω–∞ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab: —Å—Ç–∞—Ç—É—Å 200 –∏–ª–∏ –æ—à–∏–±–∫–∞?
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å database connection:
   ```bash
   PGPASSWORD="$POSTGRES_PASSWORD" psql -h "rc1a-u6gmh29sivrjjbc8.mdb.yandexcloud.net" -p 6432 -U admin_R5 -d wb_reputation -c "SELECT COUNT(*) FROM manager_tasks;"
   ```

### –§–∏–ª—å—Ç—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü—Ä–æ–±–ª–µ–º–∞**: –í—ã–±–æ—Ä —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–µ –º–µ–Ω—è–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å useEffect dependencies –≤ `src/app/tasks/page.tsx`:
   ```typescript
   useEffect(() => {
     fetchData();
   }, [filterStatus, filterAction, filterStore, sortBy, searchQuery]);
   ```
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `fetchData()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

### –°—Ç–∞—Ç—É—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–ª–∏–∫ "–ù–∞—á–∞—Ç—å" / "–ó–∞–≤–µ—Ä—à–∏—Ç—å" –Ω–µ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API endpoint `/api/tasks/[taskId]` –≤ Network tab
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `updateTaskStatus()` –≤—ã–∑—ã–≤–∞–µ—Ç `fetchData()` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ backend –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `completed_at` –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ "completed"

### KPI –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ö–∞—Ä—Ç–æ—á–∫–∏ KPI –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ–≤–µ—Ä–Ω—ã–µ —Ü–∏—Ñ—Ä—ã

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/tasks/stats` endpoint
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å –≤ `src/db/helpers.ts` ‚Üí `getManagerTaskStats()`
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–∏–ª—å—Ç—Ä `status != 'completed' AND status != 'cancelled'` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

---

## üìö –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **Database Schema**: `docs/database-schema.md`
- **API Routes**: `docs/DEVELOPMENT.md`
- **CRON Jobs**: `docs/CRON_JOBS.md`
- **UI Design System**: `docs/UI_DESIGN_SYSTEM.md`

---

## ‚úÖ Checklist –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫ (1-2 –Ω–µ–¥–µ–ª–∏)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –∏–∑ CRON jobs (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∂–∞–ª–æ–±)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á –ø—Ä–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–∞—Ç–æ–≤
- [ ] –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–¥–∞—á–∏ `/tasks/[taskId]`

### –°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ (3-4 –Ω–µ–¥–µ–ª–∏)
- [ ] –ü–∞–≥–∏–Ω–∞—Ü–∏—è (50 –∑–∞–¥–∞—á –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
- [ ] –ö–æ–ª–æ–Ω–∫–∞ "–¢–æ–≤–∞—Ä" —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- [ ] Bulk actions (–º–∞—Å—Å–æ–≤–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤)

### –î–æ–ª–≥–∏–π —Å—Ä–æ–∫ (1-2 –º–µ—Å—è—Ü–∞)
- [ ] Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö
- [ ] Dashboard badge —Å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏
- [ ] –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞–¥–∞—á–∏ (audit log)
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–¥–∞—á –≤ CSV/Excel

---

## üöÄ –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### Chrome Extension Integration (Priority: P0, CRITICAL)

**–°—Ç–∞—Ç—É—Å**: –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ, BLOCKED

**–ü—Ä–æ–±–ª–µ–º–∞**:
- WB –æ—Ç–∫–∞—Ç–∏–ª –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–¥–∞–≤—Ü–∞ –Ω–∞ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é (27 —è–Ω–≤–∞—Ä—è 2026)
- –¢–µ–∫—É—â–∏–π –ø–∞—Ä—Å–µ—Ä (PageParser v2) —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ —Å –Ω–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
- –ü–∞—Ä—Å–µ—Ä –ø–µ—Ä–µ—Å—Ç–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ –æ—Ç–∫–∞—Ç–∞

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**:
1. ‚è≥ –ü–æ–ª—É—á–∏—Ç—å HTML —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ WB (–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
2. ‚è≥ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É —Å—Ç–∞—Ä–æ–π –∏ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏—è–º–∏
3. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `parseReviewsV1()` –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
4. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `detectInterfaceVersion()` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
5. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä –Ω–∞ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –¢—Ä–µ–±—É–µ—Ç—Å—è HTML –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `docs/CHROME_EXTENSION_INTEGRATION.md`

**ETA**: 1-2 –¥–Ω—è –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è HTML

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2026-01-27
**–ê–≤—Ç–æ—Ä**: Claude AI (–Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã R5 saas-prod)
**–°—Ç–∞—Ç—É—Å**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –¥–ª—è MVP –≤–µ—Ä—Å–∏–∏ 1.0
